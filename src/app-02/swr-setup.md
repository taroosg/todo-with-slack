# ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®æœ€é©åŒ–

ã“ã“ã¾ã§ï¼Œè¬›ç¾© 1 å›ã‚ã§ä½¿ç”¨ã—ãŸ `useEffect` ã‚’ç”¨ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ãŸãŒï¼Œæœ€æ–°ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã«ã¯å†åº¦èª­ã¿è¾¼ã¿ã‚’è¡Œã†å¿…è¦ãŒã‚ã£ãŸï¼

ã—ã‹ã—ï¼Œé »ç¹ã«æƒ…å ±ãŒæ›´æ–°ã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆï¼Œãƒ¦ãƒ¼ã‚¶ã®å†èª­è¾¼ã‚’ãƒˆãƒªã‚¬ã«ã—ãŸãƒ‡ãƒ¼ã‚¿å–å¾—ã¯ç¾å®Ÿçš„ã§ã¯ãªã„ï¼

æœ¬é …ã§ã¯ï¼Œæ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è§£èª¬ã—ï¼Œæœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é©ã—ãŸå‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ï¼

## ãƒ‡ãƒ¼ã‚¿å–å¾—ã¨åæ˜ æ–¹æ³•ã®ç´¹ä»‹

é›‘ãªç´¹ä»‹ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šï¼

| åç§° | æ¦‚è¦                                                                                                                                                                                                                                            |
| ---- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SSR  | ã‚µãƒ¼ãƒå´ã§ HTML ã‚’ç”Ÿæˆã™ã‚‹æ–¹å¼ï¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ JS ãŒå®Ÿè¡Œã•ã‚Œãªãã¦ã‚‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå­˜åœ¨ã™ã‚‹çŠ¶æ³ã¨ãªã‚‹ï¼                                                                                                                                          |
| SSG  | ã‚µãƒ¼ãƒä¸Šã§ï¼ŒMD ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã‹ã‚‰ HTML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ï¼Œã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã‹ã‚‰ã¯ HTML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã‚€ã ã‘ã«ã™ã‚‹æ–¹å¼ï¼ã‚µãƒ¼ãƒä¸Šã«ã¯é™çš„ãªï¼ˆstaticï¼‰ HTML ãŒç½®ã‹ã‚Œã¦ã„ã‚‹çŠ¶æ³ã¨ãªã‚‹ï¼ã‚½ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚ŒãŸå ´åˆã¯é–‹ç™ºè€…å´ãŒå†åº¦ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ï¼ |
| ISR  | SSG ã‚’åŠ¹ç‡ã‚ˆãå®Ÿç¾ã™ã‚‹ãŸã‚ã®æ–¹æ³•ï¼æŒ‡å®šæ™‚é–“æ¯ã« SSG ã®ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ï¼é–‹ç™ºè€…ãŒéƒ½åº¦ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã†ã“ã¨ãªãï¼Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’æœ€æ–°ã«ä¿ã¤ã“ã¨ãŒã§ãã‚‹ï¼                                                                               |
| CSR  | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§å‹•ä½œã™ã‚‹ JS ãŒ HTML è¦ç´ ã‚’ç”Ÿæˆã™ã‚‹æ–¹å¼ï¼ä¸»ã«ã‚µãƒ¼ãƒã‹ã‚‰ JSON å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šï¼Œ JS ãŒ HTML è¦ç´ ã‚’æ§‹ç¯‰ã—ã¦ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹æµã‚Œã¨ãªã‚‹ï¼React ã§ã¯ useEffect ã‚„ axios ã‚’ä½¿ç”¨ã—ãŸä¸€èˆ¬çš„ãªå®Ÿè£…ï¼                                |
| SWR  | CSR ã‚’åŠ¹ç‡ã‚ˆãå®Ÿç¾ã™ã‚‹ãŸã‚ã®æ–¹æ³•ï¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§å†èª­è¾¼ã‚’è¡Œã‚ãªãã¦ã‚‚ï¼ŒæŒ‡å®šæ™‚é–“æ¯ã‚„ãƒ¦ãƒ¼ã‚¶æ“ä½œã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ‡ãƒ¼ã‚¿å–å¾—å‡¦ç†ã‚’å‹•ä½œã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼useSWR ã‚’ä½¿ç”¨ã—ã¦å®Ÿè£…ãŒå¯èƒ½ï¼                                                               |

## ä½¿ã„åˆ†ã‘

ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹ï¼

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®çŠ¶æ…‹ã‚’ã©ã®ç¨‹åº¦ã®é »åº¦ã§æœ€æ–°ã«ä¿ã¤å¿…è¦ãŒã‚ã‚‹ã®ã‹ã«ã‚ˆã‚Šï¼Œæœ€é©ãªå®Ÿè£…ã¯ç•°ãªã‚‹ï¼

ã„ãã¤ã‹ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã™ï¼

| çŠ¶æ³                                   | å®Ÿè£…            |
| -------------------------------------- | --------------- |
| é–‹ç™ºè€…ã®å€‹äººãƒ–ãƒ­ã‚°ï¼Œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãªã©ï¼ | SSG             |
| ãƒ¦ãƒ¼ã‚¶æŠ•ç¨¿å‹ã®ãƒ–ãƒ­ã‚°ãªã©ï¼             | SSGï¼ˆISR ä½¿ç”¨ï¼‰ |
| ãƒ¦ãƒ¼ã‚¶çŸ­æ–‡æŠ•ç¨¿å‹ã® SNS ãªã©ï¼          | CSRï¼ˆSWR ä½¿ç”¨ï¼‰ |

ã‚ˆã‚Šå³å¯†ãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹å ´åˆï¼ˆãƒ¦ãƒ¼ã‚¶åŒå£«ã®ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ï¼‰ã«ã¯ã‚µãƒ¼ãƒå´ã§ web socket ã®å®Ÿè£…ãªã©ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ï¼

## å®Ÿè£…

ä»Šå›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ï¼Œã™ã§ã« CSR ã«ã¦å®Ÿè£…ã‚’è¡Œã£ã¦ã„ã‚‹ï¼

todo ä¸€è¦§è¡¨ç¤ºã«ãŠã„ã¦ï¼Œã‚ˆã‚ŠæŸ”è»Ÿãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã‚‹ã‚ˆã† SWR ã‚’ç”¨ã„ãŸå®Ÿè£…ã‚’è¿½åŠ ã§è¡Œã†ï¼

## SWR å‡¦ç†ã®å®Ÿè£…

SWR ã®æ©Ÿèƒ½ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã‚‹ï¼

ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼

```bash
$ npm i swr
```

`TodoIndex.jsx` ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã™ã‚‹ï¼

ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã® `fetcher` é–¢æ•°ã‚’å®šç¾©ã—ï¼Œ`useSWR` ã§ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã€ã¨ã€Œãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°ã€ã‚’æŒ‡å®šã™ã‚‹ï¼

> è§£èª¬
>
> - å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã¨å¤±æ•—ã—ãŸå ´åˆã®ã‚¨ãƒ©ãƒ¼ã¯ãã‚Œãã‚Œ `data` ã¨ `error` ã«æ ¼ç´ã•ã‚Œã‚‹ï¼
>
> - ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã‹ã£ãŸå ´åˆã‚„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã„å ´åˆã¯ãã‚Œãã‚Œ `undefined` ã¨ãªã‚‹ãŸã‚ï¼Œå®¹æ˜“ã«æ¡ä»¶åˆ†å²ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼

```js
// src/pages/TodoIndex.jsx

// çœç•¥

// ğŸ”½ è¿½åŠ 
import useSWR from "swr";

export const TodoIndex = () => {
  // çœç•¥

  // ğŸ”½ è¿½åŠ 
  const fetcher = async (url) => (await axios.get(url)).data.result;

  // ğŸ”½ è¿½åŠ 
  const { data, error } = useSWR("http://localhost:3001/todo", fetcher);

  // ğŸ”½ è¿½åŠ 
  return (
    <ul>
      {data?.map((x, i) => (
        <Todo
          key={x.id}
          id={x.id}
          todo={x.todo}
          deadline={x.deadline}
          is_done={x.is_done}
          user_id={x.user_id}
          created_at={x.created_at}
          updated_at={x.updated_at}
          getData={getAllTodo}
        />
      ))}
    </ul>
  );
};
```

## å‹•ä½œç¢ºèª

ã“ã‚Œã¾ã§ã¨åŒæ§˜ã®å‹•ä½œã«ãªã£ã¦ã„ã‚Œã° OKï¼
